CREATE DATABASE  IF NOT EXISTS `ts1`;
USE `ts1`;

DROP TABLE IF EXISTS `followers`;
CREATE TABLE `followers` (
  `uid` varchar(20) NOT NULL,
  `fid` varchar(20) NOT NULL,
  PRIMARY KEY (`uid`,`fid`),
  KEY `fid_users_fk` (`fid`),
  CONSTRAINT `fid_users_fk` FOREIGN KEY (`fid`) REFERENCES `users` (`uid`),
  CONSTRAINT `uid_users_fk` FOREIGN KEY (`uid`) REFERENCES `users` (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `tweets`;
CREATE TABLE `tweets` (
  `tid` int NOT NULL AUTO_INCREMENT,
  `uid` varchar(20) DEFAULT NULL,
  `postdatetime` timestamp NULL DEFAULT NULL,
  `content` varchar(100) DEFAULT NULL,
  `pid` int DEFAULT NULL,
  `likes` int DEFAULT NULL,
  PRIMARY KEY (`tid`),
  KEY `tweets_users_fk` (`uid`),
  KEY `tweets_tweets_fk` (`pid`),
  CONSTRAINT `tweets_tweets_fk` FOREIGN KEY (`pid`) REFERENCES `tweets` (`tid`),
  CONSTRAINT `tweets_users_fk` FOREIGN KEY (`uid`) REFERENCES `users` (`uid`)
) ENGINE=InnoDB AUTO_INCREMENT=294 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

DROP TABLE IF EXISTS `users`;
create table `users`(
   ID INT NOT NULL AUTO_INCREMENT,
   uid VARCHAR(24) NOT NULL,
   email VARCHAR(24) NOT NULL,
   password VARCHAR(255) NOT NULL,
   salt VARCHAR(24) NOT NULL,
   submission_date DATETIME,
   PRIMARY KEY ( ID ),
   UNIQUE KEY ( uid,email )
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `likes`;
create table `likes`(
   ID INT NOT NULL AUTO_INCREMENT,
   tweet_ID INT NOT NULL,
   uid VARCHAR(24) NOT NULL,
   like_date DATETIME,
   PRIMARY KEY ( ID )
);


